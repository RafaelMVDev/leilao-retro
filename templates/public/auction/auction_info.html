{% extends "layouts/base.html" %}
{% block title %} Maradindiduns - Detalhes Leilão {% endblock %}

{% block css %}
    <link rel="stylesheet" href="{{url_for('static',filename = 'css/public/auction/auction_info_style.css')}}">
{% endblock %}
{% block js %}
    <script src="{{url_for('static',filename = 'js/public/auction/auction_info.js')}}" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
{% endblock %}

{% block content %}
    <main class="auction-details-main">
        <div class="details-container">

            <!-- Substituir imagens fixas por comandos Jinja que variam de acordo com as imagens
             do banco de dados -->
            <section class="image-section">
                <div id="main-image-placeholder" class="main-image-placeholder"></div>
                <div id="thumbnail-gallery" class="thumbnail-gallery"></div>
            </section>

            <section class="info-section">
                <div class="info-card">

                    <span id="auction-status" class="auction-status"></span>

                    <h1 id="auction-title" class="auction-title"></h1>
                    
                    <p id="auction-seller" class="auction-seller"></p>

                    <!-- NOVO: Placeholder para o Saldo do Usuário -->
                    <div id="user-balance" class="user-balance-info mb-6"></div>

                    <div class="metrics-grid">
                        <div class="metric-item">
                            <span>Lance Atual</span>
                            <strong id="current-bid-value"></strong>
                        </div>
                        <div class="metric-item">
                            <span>Lances Totais</span>
                            <strong id="total-bids-count"></strong>
                        </div>
                        <div class="metric-item time-metric">
                            <span>Tempo Restante</span>
                            <strong id="time-remaining"></strong>
                        </div>
                    </div>
                    
                    <div class="bid-section">
                        <h3>Dê seu Lance Agora</h3>
                        
                        <div class="bid-input-group">
                            <input id="bid-input" type="number" step="0.01">
                            <button id="bid-button" class="bid-button">Dar Lance!</button>
                        </div>
                        <p id="min-bid-text"></p>

                        <!-- NOVO: Caixa para mensagens de erro/sucesso -->
                        <div id="bid-message-box" class="message-box mt-3"></div>
                    </div>
                </div>
            </section>
            
            <section class="secondary-section">
                <div class="info-card">
                    <div class="tabs">
                        <div class="tab-button active" data-tab="details" onclick="switchTab('details')">Detalhes do Produto</div>
                        <div class="tab-button" data-tab="specs" onclick="switchTab('specs')">Especificações</div>
                        <div class="tab-button" data-tab="history" onclick="switchTab('history')">Histórico de Lances</div>
                    </div>

                    <div id="tab-details" class="tab-content">
                        <h4>Descrição Completa</h4>
                        <p id="details-description"></p>
                    </div>

                    <div id="tab-specs" class="tab-content" style="display: none;">
                        <h4>Detalhes Técnicos e Inclusos</h4>
                        <ul id="specs-list"></ul>
                    </div>
                    
                    <div id="tab-history" class="tab-content" style="display: none;">
                        <h4>Últimos Lances Registrados</h4>
                        <div id="bid-history-content"></div>
                    </div>
                </div>
            </section>

        </div>
    </main>

    <div id="confirmation-modal" class="modal-overlay hidden fixed top-0 left-0 w-full h-full bg-black/70 flex justify-center items-center z-50">
        <div class="modal-content bg-white p-6 rounded-lg max-w-sm mx-auto shadow-2xl">
            <h4 class="text-xl font-bold text-gray-800 mb-4">Confirmar Lance</h4>
            <p class="mb-6 text-gray-600">
                Você está prestes a dar um lance no valor de <strong id="modal-bid-value" class="text-lg text-blue-600">R$ 0,00</strong>.
                <br>
                Seu saldo estimado após esta transação será de <strong id="modal-new-balance" class="text-lg text-green-600">R$ 0,00</strong>.
            </p>
            <p class="mb-4 text-sm text-red-500">A confirmação final será feita pelo servidor.</p>
            <div class="flex justify-between gap-3">
                <button id="modal-confirm-btn" class="px-4 py-2 rounded-lg bg-green-500 text-white hover:bg-green-600 flex-1">Confirmar e Enviar</button>
                <button id="modal-cancel-btn" class="px-4 py-2 rounded-lg bg-red-500 text-white hover:bg-red-600 flex-1">Cancelar</button>
            </div>
        </div>
    </div>
{% endblock %}